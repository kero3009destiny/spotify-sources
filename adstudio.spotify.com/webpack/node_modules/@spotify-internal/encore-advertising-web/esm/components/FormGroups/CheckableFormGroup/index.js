var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};
import React from 'react';
import { FormCheckbox, spacer16, spacer12, spacer4, } from '@spotify-internal/encore-web';
import { uniqueId } from 'lodash';
import { CollapsibleFormGroupHelper, } from '../CollapsibleFormGroupHelper';
import styled from 'styled-components';
const Description = styled.div `
  margin-left: calc(
    ${spacer16} + ${spacer12}
  ); //checkbox width + gap between checkbox and label
`;
const StyledCheckbox = styled(FormCheckbox) `
  &:checked + label > span:first-of-type {
    background-image: url('data:image/svg+xml;charset=utf-8, %3Csvg%20width%3D%2210%22%20height%3D%2210%22%20viewBox%3D%220%200%2010%209%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M1%204l3%203%205-6%22%20stroke-width%3D%222%22%20stroke%3D%22%2391EEDA%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E');
  }
`;
const CheckboxContainer = styled.div `
  display: flex;
  & > div {
    padding: 0;
    min-height: auto;
    margin-right: ${spacer4};
    label {
      display: flex;
      > span {
        top: 0;
      }
    }
  }
`;
export const CheckableFormGroup = (_a) => {
    var { checked, defaultChecked, indeterminate, 'aria-checked': ariaChecked, disabled, onChange, description, children } = _a, formGroupProps = __rest(_a, ["checked", "defaultChecked", "indeterminate", 'aria-checked', "disabled", "onChange", "description", "children"]);
    const id = React.useMemo(() => uniqueId('checkable-form-group'), []);
    const [isChecked, setIsChecked] = React.useState(checked || !!defaultChecked);
    React.useEffect(() => {
        if (checked !== undefined)
            setIsChecked(checked);
    }, [checked]);
    const onCheck = React.useCallback(() => {
        if (checked !== undefined) {
            onChange === null || onChange === void 0 ? void 0 : onChange(!checked);
            return;
        }
        setIsChecked(prevChecked => {
            onChange === null || onChange === void 0 ? void 0 : onChange(!prevChecked);
            return !prevChecked;
        });
    }, [checked, onChange]);
    return (React.createElement(CollapsibleFormGroupHelper, Object.assign({}, formGroupProps, { isExpanded: isChecked, disabled: disabled, onLabelClick: onCheck, description: description && React.createElement(Description, null, description), icon: React.createElement(CheckboxContainer, null,
            React.createElement(StyledCheckbox, { "data-testid": "checkbox", id: id, checked: isChecked, indeterminate: indeterminate, disabled: disabled, "aria-checked": ariaChecked, onChange: onCheck })) }), children));
};
//# sourceMappingURL=index.js.map